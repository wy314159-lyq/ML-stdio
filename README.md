# MatSci-ML Studio

<div align="center">
  <h3>材料科学机器学习综合平台</h3>
  <p>一个功能强大的材料科学数据分析与机器学习应用程序</p>
</div>

## 📋 概述

MatSci-ML Studio是一个专为材料科学领域设计的综合性机器学习平台，提供从数据处理、特征工程到模型训练、预测和主动学习优化的完整解决方案。该软件采用模块化设计，通过直观的图形界面使材料科学家能够轻松应用先进的机器学习技术进行材料性能预测和优化。

## 🔍 主要特点

- **全流程数据分析**：从数据导入到结果可视化的完整工作流程
- **高级预处理功能**：缺失值处理、异常值检测、数据转换等
- **特征工程与选择**：自动特征提取、重要性分析和降维
- **多种机器学习模型**：支持分类和回归任务的各类算法
- **模型解释性**：基于SHAP的模型解释和可视化
- **主动学习优化**：贝叶斯优化和多目标优化算法
- **可视化分析**：丰富的数据和结果可视化工具
- **实验管理**：系统化管理和比较实验结果

## 🧩 模块结构

### 核心模块 (`/modules`)

1. **数据模块 (`data_module.py`)**
   - 数据导入、探索、清洗和预处理
   - 支持CSV、Excel等多种格式

2. **高级预处理 (`advanced_preprocessing.py`)**
   - 缺失值处理、异常值检测
   - 数据转换和标准化
   - 智能数据清洗推荐

3. **特征工程 (`feature_module.py`)**
   - 特征选择和重要性分析
   - 降维技术（PCA、t-SNE等）
   - 自动特征生成

4. **模型训练 (`training_module.py`)**
   - 多种机器学习算法支持
   - 超参数优化
   - 交叉验证和模型评估

5. **预测模块 (`prediction_module.py`)**
   - 模型预测和结果导出
   - 批量预测功能
   - 预测结果可视化

6. **SHAP分析 (`shap_analysis.py`)**
   - 基于SHAP的模型解释
   - 特征重要性可视化
   - 决策依据分析

7. **目标优化 (`target_optimization.py`)**
   - 单目标优化算法
   - 基于模型的材料性能优化

8. **多目标优化 (`multi_objective_optimization.py`)**
   - 多目标优化算法
   - Pareto前沿分析

9. **主动学习优化器 (`active_learning_optimizer.py`)**
   - 贝叶斯优化引擎
   - 自适应采样策略
   - 多源不确定性融合
   - 在线学习增强
   - 智能停止条件
   - 批量采样优化
   - 实验管理
   - 学习曲线分析
   - 模型诊断

10. **其他辅助模块**
    - 性能监控 (`performance_monitor.py`)
    - 增强可视化 (`enhanced_visualizations.py`)
    - 智能向导 (`intelligent_wizard.py`)
    - 协作与版本控制 (`collaboration_version_control.py`)

### 用户界面 (`/ui`)

1. **主窗口 (`main_window.py`)**
   - 应用程序主界面
   - 模块导航和集成

2. **主动学习窗口 (`active_learning_window.py`)**
   - 主动学习和优化界面
   - 实验设计和结果可视化
   - 推荐系统和数据探索

### 工具函数 (`/utils`)

1. **数据工具 (`data_utils.py`)**
   - 数据加载和处理函数
   - 数据质量报告

2. **机器学习工具 (`ml_utils.py`)**
   - 模型选择和评估函数
   - 特征选择工具
   - 超参数优化

3. **绘图工具 (`plot_utils.py`)**
   - 数据可视化函数
   - 结果图表生成

4. **预测工具 (`prediction_utils.py`)**
   - 预测辅助函数
   - 结果处理

5. **特征名称工具 (`feature_name_utils.py`)**
   - 特征命名和标准化
   - 特征组管理

## 📚 模块详细功能

### 1. 数据模块 (`data_module.py`)

数据模块是MatSci-ML Studio的基础组件，负责数据的导入、探索、清洗和预处理工作。该模块提供了直观的图形界面，使用户能够轻松地处理各种格式的数据文件。

#### 主要功能：

- **数据导入**
  - 支持CSV、Excel等多种文件格式
  - 可自定义分隔符、编码和表头行
  - 支持从剪贴板导入数据
  - 自动处理编码问题和格式转换

- **数据探索与可视化**
  - 数据概览：显示行数、列数、数据类型等基本信息
  - 缺失值分析：热图和条形图可视化缺失值分布
  - 相关性分析：特征间相关性热图
  - 数据分布可视化：直方图、箱线图、饼图等
  - 数据类型统计：数据类型分布、内存使用情况

- **数据清洗**
  - 缺失值处理：支持删除行/列、均值/中位数/众数填充等
  - 重复数据检测与删除
  - 数据质量自动分析与建议

- **特征与目标选择**
  - 交互式特征选择界面
  - 目标变量设置
  - 任务类型自动推断（分类/回归）
  - 选择验证与确认机制

- **类别特征编码**
  - One-Hot编码：为每个类别创建布尔列
  - 标签编码：将类别转换为整数
  - 二进制编码：将类别转换为二进制表示
  - 编码方法详细说明与建议

- **数据预处理流程管理**
  - 处理步骤记录与可视化
  - 数据状态检查
  - 预处理结果应用与导出

#### 技术特点：

- **内存优化**：高效处理大型数据集
- **错误处理**：健壮的异常捕获与用户友好的错误提示
- **数据一致性**：确保特征和目标变量处理的一致性
- **防止数据泄露**：目标编码在训练阶段进行，避免信息泄露
- **自动化建议**：基于数据特性提供智能预处理建议

#### 用户界面组件：

- 文件选择与导入选项面板
- 数据预览表格
- 交互式可视化面板（多标签页）
- 特征与目标选择列表
- 数据质量分析报告
- 类别编码配置面板

#### 与其他模块的集成：

- 将处理后的数据传递给特征工程模块
- 与高级预处理模块协同工作
- 为模型训练提供经过清洗的数据集
- 记录特征编码信息，供预测模块使用

### 2. 高级预处理模块 (`advanced_preprocessing.py`)

高级预处理模块是MatSci-ML Studio中的专业数据处理工具，提供了比基础数据模块更为强大和精细的数据清洗、转换和优化功能。该模块专注于提高数据质量，为后续的特征工程和模型训练奠定坚实基础。

#### 主要功能：

- **数据质量评估**
  - 全面的数据质量分析框架
  - 多维度评分系统：完整性、唯一性、有效性、一致性和相关性
  - 自动生成数据质量等级和详细报告
  - 可视化数据质量指标和问题区域

- **智能推荐引擎**
  - 基于数据特性自动生成预处理建议
  - 优先级排序的推荐列表
  - 一键应用推荐的预处理操作
  - 自定义推荐规则和阈值

- **高级异常值检测**
  - 多种检测算法：IQR、Z-Score、隔离森林、局部异常因子
  - 可视化异常值分布和影响
  - 多种异常值处理方法：删除、截断、替换
  - 特定列异常值定向处理

- **智能缺失值处理**
  - 缺失值模式可视化和分析
  - 高级填充方法：KNN填充、迭代填充、多重插补
  - 填充效果对比和评估
  - 缺失值处理的影响分析

- **数据转换与标准化**
  - 多种数据变换方法：标准化、归一化、对数变换等
  - 自动检测和处理偏斜分布
  - 批量特征转换
  - 转换前后分布对比可视化

- **性能优化**
  - 大型数据集内存优化
  - 数据类型自动优化
  - 数据采样与预览优化
  - 处理性能监控

- **操作历史与状态管理**
  - 完整的操作历史记录
  - 撤销/重做功能
  - 数据状态快照和恢复
  - 处理流程可视化

- **数据导出与集成**
  - 灵活的数据导出选项
  - 多种导出格式支持
  - 预处理结果预览
  - 与后续模块无缝集成

#### 技术特点：

- **高级算法集成**：整合了多种统计和机器学习方法进行数据分析和处理
- **自适应处理**：根据数据特性自动调整处理策略
- **可视化驱动**：通过丰富的可视化帮助理解数据问题和处理效果
- **高度可定制**：提供详细的参数控制和处理选项
- **智能自动化**：减少手动干预，提高数据处理效率

#### 用户界面组件：

- 数据质量分析仪表板
- 智能推荐列表与应用界面
- 交互式异常值检测与处理面板
- 缺失值分析与填充控制面板
- 数据转换与分布可视化界面
- 操作历史与状态管理控制台
- 数据导出与预览界面

#### 与其他模块的集成：

- 接收基础数据模块传递的初步清洗数据
- 提供高质量的预处理数据给特征工程模块
- 与数据可视化模块协同提供深入分析
- 为模型训练提供经过优化的高质量数据集

### 3. 特征工程模块 (`feature_module.py`)

特征工程模块是MatSci-ML Studio的核心组件之一，专注于特征选择、特征提取和特征优化，旨在从原始数据中提取最有价值的信息，提高模型性能和解释性。该模块提供了多种先进的特征工程技术和自动化工具。

#### 主要功能：

- **特征重要性分析**
  - 多种重要性评估方法：基于树的特征重要性、排列重要性、SHAP值
  - 交互式特征重要性可视化
  - 基于阈值的特征筛选
  - 特征重要性排名与导出

- **相关性分析与过滤**
  - 特征间相关性矩阵计算与可视化
  - 高相关性特征自动检测
  - 多种相关性过滤策略：基于阈值、聚类、最大信息量
  - 过滤前后相关性对比分析

- **高级特征子集搜索**
  - 多种搜索算法：穷举搜索、遗传算法、序列特征选择
  - 交叉验证评估特征子集性能
  - 特征组合性能可视化
  - 最优特征子集自动选择

- **超参数优化**
  - 特征选择与模型参数联合优化
  - 高效搜索策略：贝叶斯优化、随机搜索、网格搜索
  - 早停机制减少计算开销
  - 优化结果可视化与分析

- **并行计算加速**
  - 多核并行特征评估
  - 批处理特征组合评估
  - 进度监控与资源管理
  - 大规模特征空间高效搜索

- **特征工程配置管理**
  - 特征选择配置保存与加载
  - 预设配置模板
  - 特征工程流程记录
  - 配置参数自动建议

- **结果可视化与解释**
  - 多维特征性能可视化
  - 特征选择过程追踪
  - 遗传算法进化过程可视化
  - 特征子集性能对比分析

#### 技术特点：

- **高级算法实现**：整合了经典和最新的特征选择算法
- **计算效率优化**：通过并行计算和智能搜索策略提高效率
- **自适应特征选择**：根据数据特性和任务类型自动调整选择策略
- **全面性能评估**：使用交叉验证和多种评估指标确保特征子集稳健性
- **与模型训练集成**：特征选择与模型训练紧密结合，确保最佳性能

#### 用户界面组件：

- 数据与任务信息面板
- 模型选择与配置控制台
- 特征选择方法配置面板
- 超参数优化设置界面
- 执行控制与进度监控
- 结果可视化与分析标签页
- 特征导出与应用控制台

#### 与其他模块的集成：

- 接收预处理模块提供的清洗数据
- 将优选特征集传递给模型训练模块
- 与SHAP分析模块协同提供特征解释
- 为主动学习优化提供特征重要性信息
- 与预测模块共享特征选择配置，确保一致性

### 4. 预测模块 (`prediction_module.py`)

预测模块是MatSci-ML Studio的应用端点，负责加载训练好的模型并进行预测，提供了灵活的预测接口和详细的结果分析功能。该模块支持多种预测模式，满足不同的应用场景需求。

#### 主要功能：

- **模型加载与管理**
  - 支持从文件加载保存的模型
  - 直接使用当前训练的模型
  - 模型元数据提取与显示
  - 模型版本管理

- **详细模型信息展示**
  - 模型类型与架构信息
  - 训练参数与性能指标
  - 特征重要性排名
  - 模型适用范围与限制

- **多模式预测**
  - 批量数据预测：支持CSV、Excel文件导入
  - 手动输入预测：交互式特征值输入界面
  - 剪贴板数据预测：快速粘贴数据进行预测
  - 原始特征与转换特征双接口

- **增强型手动输入界面**
  - 特征类型感知输入控件
  - 特征取值范围提示
  - 样本值快速加载
  - 实时输入验证

- **预测数据验证**
  - 自动检测缺失值和异常值
  - 特征类型与范围验证
  - 与训练数据分布对比
  - 预处理步骤自动应用

- **预测结果分析**
  - 详细的预测结果表格
  - 预测值与置信区间
  - 结果排序与筛选
  - 预测结果统计分析

- **结果可视化**
  - 预测结果分布图
  - 预测值与重要特征关系图
  - 不确定性可视化
  - 预测结果对比图

- **结果导出**
  - 多种格式导出：CSV、Excel
  - 自定义导出字段
  - 批量预测结果导出
  - 导出预览与配置

#### 技术特点：

- **模型兼容性**：支持多种机器学习模型格式
- **预处理一致性**：确保与训练阶段使用相同的预处理步骤
- **用户友好界面**：直观的预测输入和结果展示
- **错误处理**：健壮的异常捕获与用户友好的错误提示
- **高效批处理**：优化的大批量数据预测性能

#### 用户界面组件：

- 模型加载与信息面板
- 预测模式选择器
- 批量数据导入控制台
- 交互式手动输入界面
- 预测结果表格与统计信息
- 结果可视化面板
- 导出配置界面

#### 与其他模块的集成：

- 从模型训练模块接收训练好的模型
- 与数据模块共享数据导入功能
- 利用特征工程模块的特征转换配置
- 为SHAP分析提供预测样本
- 与主动学习优化模块协同进行迭代预测

### 7. 目标优化模块 (`target_optimization.py`)

目标优化模块是MatSci-ML Studio的核心组件之一，专注于材料性能预测的优化算法。该模块提供了多种优化算法，并支持实时可视化和并行处理，以提高性能和用户体验。

#### 主要功能：

- **优化算法**
  - 支持遗传算法和粒子群优化等多种算法
  - 实时进度跟踪和可视化
  - 并行处理以提高计算效率

- **约束定义**
  - 提供增强的约束定义，包括线性和非线性约束
  - 支持特征边界的定义和验证

- **特征边界**
  - 支持连续、整数、分类和二进制特征类型
  - 提供特征边界的自动检测和设置

- **实时可视化**
  - 提供优化过程的实时可视化
  - 支持多种图表和动画效果

#### 技术特点：

- **并行处理**：利用多线程和多进程技术提高计算效率
- **高级可视化**：通过Matplotlib和Seaborn提供丰富的可视化效果
- **模块化设计**：支持灵活的算法配置和扩展

#### 用户界面组件：

- 优化配置面板
- 结果展示面板
- 实时进度条和状态更新

#### 与其他模块的集成：

- 接收特征工程模块提供的特征信息
- 与多目标优化模块协同工作
- 为预测模块提供优化后的模型

### 8. 多目标优化模块 (`multi_objective_optimization.py`)

多目标优化模块允许用户使用一个或多个预训练模型进行单目标和多目标优化。该模块帮助用户找到一组Pareto最优解，代表两个不同目标之间的权衡。

#### 主要功能：

- **多目标优化**
  - 支持NSGA-II、NSGA-III、SPEA2、MOEA/D等多种算法
  - 提供Pareto前沿分析和可视化

- **算法兼容性**
  - 自动检测和兼容不同版本的pymoo库
  - 提供算法的动态加载和配置

- **约束处理**
  - 支持显式约束和隐式约束的定义和评估
  - 提供约束违例监控和处理

- **不确定性处理**
  - 提供鲁棒优化处理，支持不确定性传播
  - 支持场景优化和多场景评估

#### 技术特点：

- **动态算法加载**：根据pymoo版本动态加载合适的算法
- **鲁棒优化**：支持不确定性传播和鲁棒目标评估
- **模块化设计**：支持灵活的算法配置和扩展

#### 用户界面组件：

- 控制面板和算法配置界面
- 结果展示和Pareto前沿可视化
- 进度条和状态更新

#### 与其他模块的集成：

- 接收模型训练模块提供的模型
- 与目标优化模块协同工作
- 为预测模块提供优化后的模型和配置

### 9. SHAP分析模块 (`shap_analysis.py`)

SHAP分析模块是MatSci-ML Studio中的一个关键组件，专注于通过SHAP（Shapley Additive Explanations）提供全面的模型解释。该模块支持多种机器学习模型，并提供了丰富的可视化工具来帮助用户理解模型的决策过程。

#### 主要功能：

- **SHAP值计算**
  - 支持多种解释器类型：TreeExplainer、LinearExplainer、KernelExplainer
  - 提供现代和传统的SHAP值计算方法
  - 自动选择合适的解释器以提高兼容性

- **模型兼容性**
  - 支持多种模型类型，包括随机森林、线性回归、支持向量机等
  - 自动处理Pipeline模型的兼容性问题

- **可视化工具**
  - 提供全局和局部解释的可视化
  - 支持依赖图、力图、瀑布图等多种图表
  - 提供独立的可视化窗口以增强用户体验

- **错误处理**
  - 提供增强的错误处理机制，确保在解释器初始化失败时使用备用方法
  - 提供详细的错误信息和用户友好的提示

#### 技术特点：

- **现代接口**：使用现代的shap.Explainer接口以提高Pipeline兼容性
- **增强的错误处理**：在解释器初始化失败时提供备用方法
- **模块化设计**：支持灵活的解释器配置和扩展

#### 用户界面组件：

- 配置面板和结果展示面板
- 全局解释和局部解释标签页
- 依赖图和力图的独立窗口

#### 与其他模块的集成：

- 从模型训练模块接收训练好的模型
- 与特征工程模块共享特征选择配置
- 为预测模块提供解释结果

### 10. 主动学习优化器 (`active_learning_optimizer.py`)

主动学习优化器是MatSci-ML Studio的核心功能之一，提供了一个全面的贝叶斯优化引擎，支持多目标优化和主动学习。

#### 主要功能：

- **贝叶斯优化**
  - 支持多种代理模型：随机森林、XGBoost、LightGBM、CatBoost、SVR等
  - 提供智能的超参数优化和自动探索/利用平衡

- **多目标优化**
  - 支持单目标和多目标优化
  - 提供Pareto前沿分析和可视化

- **采样策略**
  - 自适应采样策略：动态调整探索/利用策略
  - 多源不确定性融合：结合bootstrap、MC dropout、deep ensemble等方法

- **实验管理**
  - 提供实验管理和比较功能
  - 支持学习曲线分析和模型诊断

#### 技术特点：

- **多模型支持**：支持多种机器学习模型和代理模型
- **智能优化**：提供智能的超参数优化和采样策略
- **模块化设计**：支持灵活的算法配置和扩展

#### 用户界面组件：

- 优化配置面板和结果展示面板
- 实验管理和学习曲线分析界面

#### 与其他模块的集成：

- 从数据模块接收清洗后的数据
- 与特征工程模块协同工作
- 为预测模块提供优化后的模型和配置

## 🚀 快速开始

### 安装依赖

```bash
pip install -r requirements.txt
```

### 启动应用程序

```bash
python main.py
```

### 基本工作流程

1. **数据管理**：导入数据并进行初步探索
2. **数据预处理**：处理缺失值、异常值和数据转换
3. **特征选择**：选择和优化特征集
4. **模型训练**：训练和评估机器学习模型
5. **模型预测**：使用训练好的模型进行预测
6. **结果分析**：分析和可视化结果
7. **主动学习优化**：使用主动学习进一步优化模型和探索设计空间

## 📊 主动学习优化

主动学习优化器是本软件的核心功能之一，提供以下高级特性：

- **自适应采样策略**：动态调整探索/利用策略
- **多源不确定性融合**：结合bootstrap、MC dropout、deep ensemble等方法
- **在线学习增强**：支持增量学习和模型更新
- **智能停止条件**：基于多种收敛准则的早停机制
- **批量采样优化**：平衡获取值和样本多样性
- **实验管理**：系统化管理实验流程
- **学习曲线分析**：深入分析性能变化模式
- **模型诊断**：全面评估模型健康状态

## 📝 使用指南

详细的使用指南请参考 `使用指南.md` 文件，其中包含了各模块的详细操作流程和常见问题解答。

## 🔧 系统要求

- Python 3.7+
- PyQt5 5.15.0+
- 科学计算库：NumPy、Pandas、SciPy
- 机器学习库：scikit-learn、XGBoost、LightGBM、CatBoost
- 可视化库：Matplotlib、Seaborn
- 模型解释库：SHAP

## 📄 许可证

[MIT License](LICENSE)

## 📞 联系方式

如有问题或建议，请联系：1255201958@qq.com 
